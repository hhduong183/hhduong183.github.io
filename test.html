<!DOCTYPE html>
<html>
  <head>
    <title>Sơ đồ tổ chức</title>
    <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
    <script>
      google.charts.load('current', {packages:["orgchart"]});
      google.charts.setOnLoadCallback(drawChart);

      function drawChart() {
        fetch("get_data.php") // file PHP trả về JSON
          .then(res => res.json())
          .then(data => {
            const orgData = new google.visualization.DataTable();
            orgData.addColumn('string', 'Name');
            orgData.addColumn('string', 'Manager');
            orgData.addColumn('string', 'ToolTip');

            data.forEach(row => {
              orgData.addRow([
                {v: String(row.id), f: row.name + '<div style="color:gray">' + row.title + '</div>'},
                row.parent ? String(row.parent) : null,
                row.title
              ]);
            });

            const chart = new google.visualization.OrgChart(document.getElementById('chart_div'));
            chart.draw(orgData, {allowHtml: true});
          });
      }
    </script>
  </head>
  <body>
    <h2>Sơ đồ tổ chức</h2>
    <div id="chart_div"></div>
  </body>
</html>
